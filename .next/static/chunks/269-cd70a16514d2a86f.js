"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[269],{7147:function(t,e,r){r.d(e,{Am:function(){return l},pm:function(){return p}});var a=r(2265);let o=0,n=new Map,i=t=>{if(n.has(t))return;let e=setTimeout(()=>{n.delete(t),c({type:"REMOVE_TOAST",toastId:t})},1e6);n.set(t,e)},u=(t,e)=>{switch(e.type){case"ADD_TOAST":return{...t,toasts:[e.toast,...t.toasts].slice(0,1)};case"UPDATE_TOAST":return{...t,toasts:t.toasts.map(t=>t.id===e.toast.id?{...t,...e.toast}:t)};case"DISMISS_TOAST":{let{toastId:r}=e;return r?i(r):t.toasts.forEach(t=>{i(t.id)}),{...t,toasts:t.toasts.map(t=>t.id===r||void 0===r?{...t,open:!1}:t)}}case"REMOVE_TOAST":if(void 0===e.toastId)return{...t,toasts:[]};return{...t,toasts:t.toasts.filter(t=>t.id!==e.toastId)}}},d=[],s={toasts:[]};function c(t){s=u(s,t),d.forEach(t=>{t(s)})}function l(t){let{...e}=t,r=(o=(o+1)%Number.MAX_SAFE_INTEGER).toString(),a=()=>c({type:"DISMISS_TOAST",toastId:r});return c({type:"ADD_TOAST",toast:{...e,id:r,open:!0,onOpenChange:t=>{t||a()}}}),{id:r,dismiss:a,update:t=>c({type:"UPDATE_TOAST",toast:{...t,id:r}})}}function p(){let[t,e]=a.useState(s);return a.useEffect(()=>(d.push(e),()=>{let t=d.indexOf(e);t>-1&&d.splice(t,1)}),[t]),{...t,toast:l,dismiss:t=>c({type:"DISMISS_TOAST",toastId:t})}}},1811:function(t,e,r){r.d(e,{DW:function(){return s},OQ:function(){return u},g0:function(){return d},iJ:function(){return i}});var a=r(3741),o=r(7230),n=r(2743);let i=(0,a.LC)({reducerPath:"authapi",baseQuery:(0,o.ni)({baseUrl:"http://localhost:5002",credentials:"include"}),endpoints:t=>({loginUser:t.mutation({query:t=>({url:"/user/login",method:"POST",body:t}),async onQueryStarted(t,e){let{dispatch:r,queryFulfilled:a}=e;try{var o;await a,sessionStorage.setItem("token",null===(o=(await a).data)||void 0===o?void 0:o.token),await r(n.BG.endpoints.getUser.initiate(null))}catch(t){throw Error(t.message?t.message:"Error occured  while logging in")}}}),registerUser:t.mutation({query:t=>({url:"/user/signup",method:"POST",body:t}),async onQueryStarted(t,e){let{dispatch:r,queryFulfilled:a}=e;try{var o;await a,sessionStorage.setItem("token",null===(o=(await a).data)||void 0===o?void 0:o.token),await r(n.BG.endpoints.getUser.initiate(null))}catch(t){throw Error(t.message?t.message:"Error occured  while logging in")}}}),logoutUser:t.mutation({query:()=>({url:"/user/logout",credentials:"include"})})})}),{useLoginUserMutation:u,useLogoutUserMutation:d,useRegisterUserMutation:s}=i},3093:function(t,e,r){r.d(e,{$B:function(){return d},EU:function(){return s},q8:function(){return c},wk:function(){return u}});var a=r(3741),o=r(7230),n=r(7147),i=r(895);let u=(0,a.LC)({reducerPath:"cartapi",baseQuery:(0,o.ni)({baseUrl:"http://localhost:5002",credentials:"include"}),endpoints:t=>({addToCart:t.mutation({query(t){let{pid:e,variant:r}=t;return{url:"/cart/addToCart",method:"POST",headers:{authorization:"Bearer ".concat(sessionStorage.getItem("token"))},body:{pid:e.toString(),variant:r}}},async onQueryStarted(t,e){let{dispatch:r,queryFulfilled:a}=e;try{let t=await a;r((0,i.RV)(t.data.data)),(0,n.Am)({title:"Success",description:"Your product has been added to the cart.",variant:"default",duration:1e3})}catch(t){(0,n.Am)({title:"Error",description:"Failed to add product to cart.",variant:"destructive",duration:1e3})}}}),removeFromCart:t.mutation({query:t=>({url:"/cart/removeFromCart",method:"POST",headers:{authorization:"Bearer ".concat(sessionStorage.getItem("token"))},body:{pid:t.pid.toString(),variant:t.variant}}),async onQueryStarted(t,e){let{dispatch:r,queryFulfilled:a}=e;try{let t=await a;r((0,i.RV)(t.data.data)),(0,n.Am)({title:"Success",description:"Your product has been removed from the cart.",variant:"default",duration:1e3})}catch(t){(0,n.Am)({title:"Error",description:"Failed to remove product from cart.",variant:"destructive",duration:1e3})}}}),manipulateQuantity:t.mutation({query(t){let{itemId:e,quantity:r,variant:a}=t;return{url:"/cart/changeQuantity",method:"POST",headers:{authorization:"Bearer ".concat(sessionStorage.getItem("token"))},body:{pid:e.toString(),quantity:r.toString(),variant:a}}},async onQueryStarted(t,e){let{dispatch:r,queryFulfilled:a}=e;try{let t=await a,{status:e,message:o}=t.data;console.log(e,o),400===e?(0,n.Am)({title:"Insufficient Stock",description:o,variant:"destructive",duration:1e3}):(r((0,i.RV)(t.data.data)),(0,n.Am)({title:"Success",description:"The product quantity has been updated in your cart.",variant:"default",duration:1e3}))}catch(t){(0,n.Am)({title:"Error",description:"Failed to update product quantity.",variant:"destructive",duration:1e3})}}})})}),{useAddToCartMutation:d,useRemoveFromCartMutation:s,useManipulateQuantityMutation:c}=u},1671:function(t,e,r){r.d(e,{Fr:function(){return n},NL:function(){return u},PS:function(){return s},X6:function(){return i},oP:function(){return l},pp:function(){return c},vL:function(){return d}});var a=r(3741),o=r(7230);let n=(0,a.LC)({reducerPath:"productApi",baseQuery:(0,o.ni)({baseUrl:"http://localhost:5002",credentials:"include"}),endpoints:t=>({getCategories:t.query({query:()=>({url:"category",method:"GET"})}),getProductsWithFilter:t.mutation({query:t=>{let{category:e,sort:r,pageNumber:a,search:o}=t,n="/product?limit=50&page=".concat(a+1);return(e&&(n+="&category=".concat(e)),r&&(n+="&sort=".concat(r)),null==o?void 0:o.length)?{url:"/product/search?name=".concat(o),method:"GET"}:{url:n,method:"GET"}}}),getProductById:t.query({query:t=>({url:"/product/".concat(t),method:"GET"})}),getBestSeller:t.query({query:()=>({url:"/product/bestSellers",method:"GET"})}),getNewArrival:t.query({query:()=>({url:"/product/newProducts",method:"GET"})}),getCategory:t.query({query:()=>({url:"category/",method:"GET"})})})}),{useGetProductsWithFilterMutation:i,useGetCategoriesQuery:u,useGetProductByIdQuery:d,useGetBestSellerQuery:s,useGetNewArrivalQuery:c,useGetCategoryQuery:l}=n},2743:function(t,e,r){r.d(e,{BG:function(){return d},PO:function(){return s},QH:function(){return y},Us:function(){return m},ir:function(){return f},kD:function(){return p},uZ:function(){return g}});var a=r(3741),o=r(7230),n=r(1286),i=r(895),u=r(7147);let d=(0,a.LC)({reducerPath:"userapi",tagTypes:["User"],baseQuery:(0,o.ni)({baseUrl:"http://localhost:5002",credentials:"include"}),endpoints:t=>({getUser:t.query({query:()=>({url:"/user/profile",method:"GET",headers:{authorization:"Bearer ".concat(sessionStorage.getItem("token"))}}),async onQueryStarted(t,e){let{dispatch:r,queryFulfilled:a}=e;try{let t=(await a).data.data;t&&(r((0,n.oJ)(!0)),r((0,n.YO)({email:t.email,name:t.name,password:"",address:t.address,profilePhoto:t.profilePhoto,role:t.role}))),await a,await r(d.endpoints.getCart.initiate(null))}catch(t){null==t||t.error.status}}}),getCart:t.query({query:()=>({url:"/cart/myCart",method:"GET",headers:{authorization:"Bearer ".concat(sessionStorage.getItem("token"))}}),async onQueryStarted(t,e){let{dispatch:r,queryFulfilled:a}=e;try{r((0,i.RV)((await a).data.data))}catch(t){if((null==t?void 0:t.error.status)===401){var o;let e=(null==t?void 0:null===(o=t.data)||void 0===o?void 0:o.message)||"Please log in first";(0,u.Am)({title:e,variant:"destructive",duration:2e3})}}}}),getOrder:t.query({query:()=>({url:"/order/myOrders",method:"GET",headers:{authorization:"Bearer ".concat(sessionStorage.getItem("token"))}}),async onQueryStarted(t,e){let{dispatch:r,queryFulfilled:a}=e;try{await a}catch(t){(null==t?void 0:t.error.status)===401&&(0,u.Am)({title:"Please log in first",variant:"default",duration:2e3})}}}),updateProfile:t.mutation({query:t=>({url:"/user/profile",method:"PATCH",body:t,headers:{authorization:"Bearer ".concat(sessionStorage.getItem("token"))}}),async onQueryStarted(t,e){let{dispatch:r,queryFulfilled:a}=e;try{await a,await r(d.endpoints.getUser.initiate(null))}catch(t){throw(null==t?void 0:t.error.status)===401&&(0,u.Am)({title:"Please log in first",variant:"destructive",duration:2e3}),Error((null==t?void 0:t.error.message)?null==t?void 0:t.error.message:"Error occurred updating user info.")}}}),logoutUser:t.query({query:()=>({url:"/user/logout",headers:{authorization:"Bearer ".concat(sessionStorage.getItem("token"))}})}),createOrder:t.mutation({query:t=>({url:"/order/createOrder",method:"POST",body:t,headers:{authorization:"Bearer ".concat(sessionStorage.getItem("token"))}})}),acceptPayment:t.mutation({query:t=>({method:"POST",url:"/order/acceptPayment",body:t,headers:{authorization:"Bearer ".concat(sessionStorage.getItem("token"))}})}),verifyPayment:t.mutation({query:t=>({method:"POST",url:"/order/verifyPayment",body:t,headers:{authorization:"Bearer ".concat(sessionStorage.getItem("token"))}})}),userImageupdate:t.query({query:t=>{let e=new FormData;return e.append("profilePhoto",t),{url:"/user/profile/img",method:"PATCH",body:e,headers:{authorization:"Bearer ".concat(sessionStorage.getItem("token"))}}},async onQueryStarted(t,e){let{dispatch:r,queryFulfilled:a}=e;try{let t=(await a).data.data;r((0,n.oJ)(!0)),r((0,n.YO)({email:t.email,name:t.name,password:"",address:t.address,profilePhoto:t.profilePhoto,role:t.role}))}catch(t){(null==t?void 0:t.error.status)===401&&(0,u.Am)({title:"Please log in first",variant:"destructive",duration:2e3}),console.log(t)}}})})}),{useLazyGetUserQuery:s,useUpdateProfileMutation:c,useLogoutUserQuery:l,useCreateOrderMutation:p,useAcceptPaymentMutation:y,useVerifyPaymentMutation:m,useLazyUserImageupdateQuery:h,useGetCartQuery:g,useGetOrderQuery:f}=d},1286:function(t,e,r){r.d(e,{YO:function(){return n},dX:function(){return i},oJ:function(){return o}});let a=(0,r(6608).oM)({name:"auth",initialState:{authState:!1,user:{name:"",email:"",password:"",address:[],profilePhoto:"",role:"user"}},reducers:{setAuthState:(t,e)=>{t.authState=e.payload},setAuthUser:(t,e)=>{t.user.email=e.payload.email,t.user.name=e.payload.name,t.user.address=e.payload.address,t.user.profilePhoto=e.payload.profilePhoto,t.user.address=e.payload.address,t.user.role=e.payload.role}}}),{setAuthState:o,setAuthUser:n}=a.actions,i=a.reducer},895:function(t,e,r){r.d(e,{RV:function(){return i}});let a=(0,r(6608).oM)({name:"Cart",initialState:{products:{},deliveryCharges:0,gst:0,totalQuantity:0,totalPrice:0,payablePrice:0,address:[]},reducers:{addToCart(t,e){let{product:r,variant:a}=e.payload,o="".concat(r.pid).concat(a.color).replace(/\./g,"_");o in t.products?t.products[o].quantity++:t.products[o]={product:r,quantity:1,variant:a},t.totalQuantity++,t.totalPrice+=r.price,t.deliveryCharges=59,t.gst=Math.round(.04*t.totalPrice+Number.EPSILON),t.payablePrice=t.totalPrice+t.deliveryCharges+t.gst},updateQtyInCart(t,e){let{id:r,operation:a}=e.payload,o=t.products[r].quantity;switch(a){case"increment":t.products[r].quantity++;break;case"decrement":o>1?t.products[r].quantity--:delete t.products[r];break;default:console.log("Invalid Operation!")}t.totalQuantity=Object.values(t.products).reduce((t,e)=>t+e.quantity,0),t.totalPrice=Object.values(t.products).reduce((t,e)=>t+e.product.price*e.quantity,0)},setCart(t,e){t.deliveryCharges=e.payload.deliveryCharges||0,t.gst=e.payload.gst||0,t.payablePrice=e.payload.payablePrice||0,t.products=e.payload.products||{},t.totalPrice=e.payload.totalPrice||0,t.totalQuantity=e.payload.totalQuantity||0}}});e.ZP=a.reducer;let{addToCart:o,updateQtyInCart:n,setCart:i}=a.actions},3292:function(t,e,r){r.d(e,{y$:function(){return i}});var a=r(6608);let o={shippingAddress:null,paymentId:"1313",status:"Order Placed"},n=(0,a.oM)({name:"Cart",initialState:o,reducers:{addAddress(t,e){t.shippingAddress=e.payload},setPaymentMethod(t,e){t.paymentId=e.payload},resetOrderDetails:t=>o}});e.ZP=n.reducer;let{addAddress:i,resetOrderDetails:u,setPaymentMethod:d}=n.actions},8269:function(t,e,r){r.d(e,{h:function(){return b},TL:function(){return A},CG:function(){return I}});var a=r(3646),o=r(6608),n=r(828),i=r(1286),u=r(895),d=r(1811),s=r(2743),c=r(1671),l=r(3093),p=r(3741),y=r(7230);let m=(0,p.LC)({reducerPath:"adminapi",baseQuery:(0,y.ni)({baseUrl:"http://localhost:5002",credentials:"include"}),tagTypes:["Users","Products","Orders"],endpoints:t=>({getUsers:t.query({query:()=>"/users",providesTags:["Users"]}),deleteUser:t.mutation({query:t=>({url:"users/".concat(t),method:"DELETE"})}),addProduct:t.mutation({query:t=>{let{productInfo:e,images:r}=t,a=new FormData;if(a.append("productName",e.productName),a.append("description",e.description?e.description:""),a.append("category",e.category?JSON.stringify(e.category):""),a.append("price",e.price?String(e.price):"0"),a.append("qtyavailabele",e.qtyavailable?String(e.qtyavailable):"0"),null!==r)for(let t=0;t<r.length;t++)a.append("images",r[t],r[t].name);return{url:"/products",method:"POST",transformResponse:t=>JSON.parse(t).id,body:a}}}),editProduct:t.mutation({query:t=>({url:"/products/".concat(t),method:"PATCH"})}),editProductImgs:t.query({async queryFn(t){let e=new FormData;for(let r=0;r<t.length;r++){let a=t[r];a.name||(a=new File([a],"filename",{type:a.type})),e.append("images",a,a.name)}let r=await fetch("/upload",{body:e}).then(t=>t.json());return r.data?r.data:void 0}}),deleteProduct:t.mutation({query:t=>({url:"/products/".concat(t),method:"DELETE"})}),getAllOrders:t.mutation({query:()=>({url:"/orders",method:"GET"})}),searchOrderById:t.mutation({query:t=>({url:"/searchOrder/".concat(t),method:"GET"})}),updateOrderStatus:t.mutation({query:t=>({url:"/updateOrderStatus?id=".concat(t.order_id,"&status=").concat(t.status)})})})}),{useDeleteProductMutation:h,useAddProductMutation:g,useDeleteUserMutation:f,useEditProductImgsQuery:S,useEditProductMutation:v,useGetAllOrdersMutation:P,useGetUsersQuery:q,useSearchOrderByIdMutation:T,useUpdateOrderStatusMutation:w}=m;var O=r(3292);let E=(0,a.UY)({[d.iJ.reducerPath]:d.iJ.reducer,[s.BG.reducerPath]:s.BG.reducer,[c.Fr.reducerPath]:c.Fr.reducer,[l.wk.reducerPath]:l.wk.reducer,[m.reducerPath]:m.reducer,order:O.ZP,auth:i.dX,cart:u.ZP}),b=(0,o.xC)({reducer:E,middleware:t=>t({serializableCheck:!1}).concat([d.iJ.middleware,s.BG.middleware,c.Fr.middleware,l.wk.middleware,m.middleware])}),A=()=>(0,n.I0)(),I=n.v9}}]);